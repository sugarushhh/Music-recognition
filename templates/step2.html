{% extends 'base.html' %}

{% block title %}第二步：输入待筛选歌曲 - Spotify音乐特征分析{% endblock %}

{% block content %}
<div class="card">
    <h2>第一步结果</h2>
    
    {% if results %}
    <div class="alert alert-success">
        成功分析了 {{ results|selectattr('success')|list|length }} 首歌曲作为参考组
    </div>
    
    <h3>参考歌曲列表</h3>
    <ul class="song-list">
        {% for song in results %}
        <li class="song-item">
            {% if song.success %}
            <div>
                <strong>{{ song.name }}</strong>
                <div>{{ song.artists }}</div>
            </div>
            <span class="song-status success">✓ 已分析</span>
            {% else %}
            <div>
                <strong>{{ song.name }}</strong>
                <div class="song-status error">{{ song.error }}</div>
            </div>
            <span class="song-status error">✗ 失败</span>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% endif %}
</div>

<div class="card">
    <h2>第二步：输入待筛选歌曲列表</h2>
    <p>请在下方输入您想要筛选的第二组歌曲名称（每行一首），系统将找出其中与第一组差异较大的歌曲。</p>
    
    <form action="{{ url_for('step2') }}" method="post">
        <div class="form-group">
            <label for="songs">歌曲列表（每行一首）:</label>
            <textarea id="songs" name="songs" placeholder="例如:
Bohemian Rhapsody - Queen
Hotel California - Eagles
Imagine - John Lennon" required></textarea>
        </div>
        
        <button type="submit" class="btn">分析并继续</button>
    </form>
</div>

<div class="card">
    <h2>使用说明</h2>
    <ol>
        <li>在上方文本框中输入您想要筛选的歌曲列表（每行一首）</li>
        <li>系统将自动搜索这些歌曲并收集它们的音频特征</li>
        <li>然后将这些歌曲与第一步中的参考组进行比较，找出音乐特征差异较大的歌曲</li>
        <li>您可以在下一步中查看筛选结果并决定是否接受</li>
    </ol>
</div>
{% endblock %}